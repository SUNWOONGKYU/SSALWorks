# S5 운영 (Operations) 안내문

> **작성일**: 2025-12-18
> **버전**: 2.2 (Grid 동기화)

---

## 1. Stage 맥락 (Context)

### 현재 위치
```
┌─────────────────────────────────────────────────────────────────────────┐
│                        SSAL Works 개발 흐름                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   P0~P3        ▶▶▶   S1   ▶▶▶   S2   ▶▶▶   S3   ▶▶▶   S4   ▶▶▶   [S5]  │
│   예비단계           개발준비     개발1차     개발2차     개발3차       운영   │
│   (기획/설계)        (기반구축)   (핵심기능)  (고급기능)  (QA/최적화)   (배포)  │
│                                                                 ──────  │
│                                                                 현재    │
│                                                                 Stage   │
└─────────────────────────────────────────────────────────────────────────┘
```

### Stage 간 관계

| 단계 | Stage | 설명 | 비고 |
|------|-------|------|------|
| 이전 | S4 | 개발 3차 - QA 및 최적화 완료 | ✅ 완료됨 |
| **현재** | **S5** | **운영 - 프로덕션 배포 및 운영** | **🔄 진행 중** |
| 다음 | - | 프로젝트 완료! 🎉 | - |

### 이전 단계에서 완료된 것 (S4)
- ✅ 결제 시스템 연동 (토스 페이먼트)
- ✅ 종합 테스트 (Unit, Integration, E2E)
- ✅ 성능 최적화
- ✅ 버그 수정 및 안정화
- ✅ 결제 보안 검증
- ✅ 테스트 문서화

### 현재 단계에서 수행할 것 (S5)
- 🔄 프로덕션 배포 (Vercel)
- 🔄 모니터링 시스템 구축 (Sentry)
- 🔄 RLS 정책 프로덕션 적용
- 🔄 운영 API 구현
- 🔄 운영 문서화

### 완료 후 상태
- 🎉 **프로젝트 런칭 완료!**
- 🎉 프로덕션 환경에서 서비스 운영 시작
- 🎉 사용자 접속 가능

---

## 2. Stage 개요

**S5 (운영)**는 프로덕션 배포 및 운영 단계입니다.

### Stage 목표
- 프로덕션 배포 (Vercel)
- 모니터링 시스템 구축 (Sentry)
- RLS 정책 프로덕션 적용
- 운영 API 구현
- 운영 문서화

---

## 3. Task 목록 (5개)

| Task ID | Task Name | Area | 유형 |
|---------|-----------|------|------|
| S5M1 | 운영 문서화 | Documentation | AI-Only |
| S5BA1 | 운영 API | Backend_APIs | AI-Only |
| S5S1 | RLS 정책 프로덕션 적용 | Security | **PO 실행** |
| S5O1 | 프로덕션 배포 | DevOps | **Human-AI** |
| S5O3 | 모니터링 설정 (Sentry) | DevOps | **Human-AI** |

---

## 4. 작업 규칙

### 파일 저장 규칙
S5는 운영 단계이므로 Production 폴더 이중 저장 불필요
- 모든 파일 → `S5_운영/` 하위 폴더에만 저장

### 배포 전 필수 확인

```
⚠️ CRITICAL: 배포 전 필수 체크리스트

- [ ] RLS 정책 프로덕션 버전으로 교체
- [ ] 환경변수 프로덕션 값 설정
- [ ] 테스트 모드 API 키 → 프로덕션 키 교체
- [ ] 디버그 로그 비활성화
- [ ] 에러 메시지 사용자 친화적으로 변경
```

---

## 5. 실행 프로세스 (10단계)

```
[Step 0] Order Sheet 저장
[Step 1] SSAL Grid 확인 - Stage Task 목록 조회
[Step 2] Task 실행 순서 결정 - Dependencies 기반
[Step 3] 각 Task 실행 - Task Agent 서브에이전트 투입
[Step 3-1] Human-AI Task 처리 (해당 시)
[Step 4] 결과물 저장 - Stage/Area 폴더 + Production 이중 저장
[Step 5] 검증 - Verification Agent 서브에이전트로 검증
[Step 6] Grid 업데이트 - Status, Files, Progress 기록
[Step 7] Stage Gate - 모든 Task 완료 후 Stage Gate 검증
[Step 8] PO 기능 테스트 요청 - 최종 승인
```

**핵심 원칙**:
- Task Agent ≠ Verification Agent (작성자와 검증자 분리)
- Grid가 진실의 원천: 모든 Task 정보는 SSAL Grid에 있음
- 서브에이전트 투입: Task Agent(#7), Verification Agent(#15) 사용

---

## 6. PO(Project Owner) 필수 작업

### S5O1: 프로덕션 배포
```
[배포 전 체크리스트]
1. 모든 테스트 통과 확인
2. 환경변수 프로덕션 값 설정
3. RLS 정책 프로덕션 버전 적용 (S5S1)
4. 빌드 테스트 성공

[Vercel 배포]
1. Vercel Dashboard → 프로젝트 선택
2. Settings → Environment Variables 확인
3. Deployments → Redeploy (프로덕션)
4. 배포 완료 대기
5. 프로덕션 URL 접속 테스트
```

### S5S1: RLS 프로덕션 적용

**⚠️ 매우 중요! 배포 전 필수 실행!**

```
[Supabase SQL Editor]
1. 개발용 RLS 정책 (_dev.sql) 제거:
   - 07_learning_contents_rls_dev.sql → 원래 파일로 교체
   - 10_faqs_rls_dev.sql → 원래 파일로 교체

2. 프로덕션 RLS 정책 실행:
   - 07_learning_contents_rls.sql 실행
   - 10_faqs_rls.sql 실행

3. 테스트:
   - anon 역할로 INSERT 시도 → 차단 확인
   - authenticated 역할로 INSERT 시도 → 성공 확인
```

### S5O3: 모니터링 설정
```
[Sentry 설정]
1. https://sentry.io 접속
2. 새 프로젝트 생성 (JavaScript)
3. DSN 복사
4. Vercel 환경변수 추가: SENTRY_DSN
5. 알림 설정 (이메일/Slack)
```

---

## 7. Stage Gate 완료 기준

### 체크리스트
- [ ] S5M1: 운영 문서 완성
- [ ] S5BA1: 운영 API 동작 확인
- [ ] S5S1: RLS 프로덕션 정책 적용 확인
- [ ] S5O1: 프로덕션 배포 성공
- [ ] S5O3: 에러 발생 시 Sentry 알림 확인

### 프로젝트 완료 기준

```
S5 Stage 완료 = 프로젝트 런칭!

필수 조건:
1. 프로덕션 배포 완료
2. RLS 프로덕션 정책 적용
3. 모니터링 시스템 가동
4. 운영 문서 완성
5. PO 최종 승인
```

---

## 8. 주의사항

```
⚠️ 배포 전 RLS 프로덕션 정책 필수 적용!
⚠️ 테스트 API 키 → 프로덕션 키 교체 필수!
⚠️ 도메인 SSL 인증서 발급까지 최대 24시간 소요!
⚠️ 배포 후 즉시 기능 테스트 수행!
```

---

**확인 버튼을 클릭하면 Workspace에 Order Sheet가 로드됩니다.**
