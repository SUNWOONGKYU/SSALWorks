# Order Sheet - S3 개발 2차 (Advanced Features)

> **작성일**: 2025-12-17
> **버전**: 2.0 (S2 경험 기반 역설계)
> **목적**: S3 Stage 작업을 위한 종합 Order Sheet

---

## 1. Stage 개요

### 1.1 Stage 목표

**S3 (개발 2차 - Advanced Features)**는 고급 기능을 구현하는 단계입니다.

- AI 서비스 연동 (OpenAI, Claude 등)
- 결제 시스템 기반 구축 (토스 페이먼트 준비)
- 대시보드 기능 고도화
- 알림 시스템 구축
- 고급 사용자 관리 기능

### 1.2 S3 Task 목록 (예상)

| Task ID | Task Name | Area | 유형 |
|---------|-----------|------|------|
| S3F1 | 대시보드 고도화 | Frontend | AI-Only |
| S3F2 | 알림 센터 UI | Frontend | AI-Only |
| S3F3 | AI 서비스 UI | Frontend | AI-Only |
| S3BA1 | AI 서비스 API | Backend_APIs | AI-Only |
| S3BA2 | 크레딧 관리 API | Backend_APIs | AI-Only |
| S3BA3 | 알림 API | Backend_APIs | AI-Only |
| S3BI1 | OpenAI 연동 모듈 | Backend_Infra | **Human-AI** |
| S3D1 | AI 사용량 테이블 최적화 | Database | **PO 실행** |
| S3S1 | API Rate Limiting | Security | AI-Only |
| S3T1 | AI 서비스 테스트 | Testing | AI-Only |
| S3M1 | AI 서비스 문서화 | Documentation | AI-Only |

### 1.3 의존성 관계

```
S2 Stage 완료 (필수 선행)
    │
    ├── S3BI1 (OpenAI 모듈) ──────► S3BA1
    │
    ├── S3BA1 (AI 서비스 API) ────► S3F3
    │
    ├── S3BA2 (크레딧 관리) ──────► S3F1
    │
    ├── S3BA3 (알림 API) ─────────► S3F2
    │
    └── S3T1 (테스트) ────────────► 모든 BA 완료 후
```

---

## 2. 작업 규칙 (필수 준수)

### 2.1 파일 저장 규칙 (이중 저장)

| Area | Stage 폴더 | Production 폴더 |
|------|------------|-----------------|
| F (Frontend) | `S3_개발-2차/Frontend/` | `Production/Frontend/` |
| BA (Backend_APIs) | `S3_개발-2차/Backend_APIs/` | `Production/Backend_APIs/` |
| BI (Backend_Infra) | `S3_개발-2차/Backend_Infra/` | `Production/Backend_Infra/` |
| D (Database) | `S3_개발-2차/Database/` | `Production/Database/` |

**문서 파일은 Stage 폴더에만:**
- M (Documentation) → `S3_개발-2차/Documentation/`
- T (Testing) → `S3_개발-2차/Testing/`

### 2.2 Task ID 코멘트 규칙

```javascript
// Task ID: S3BA1 - AI 서비스 API
```

```html
<!-- Task ID: S3F1 - 대시보드 고도화 -->
```

### 2.3 3단계 검증 시스템

```
[1단계] Task Agent → 작업 수행
[2단계] Verification Agent → 검증 (작성자 ≠ 검증자)
[3단계] Stage Gate → Main Agent 직접 수행
[4단계] PO 승인 → 테스트 후 승인/거부
```

---

## 3. Order Sheet 템플릿

### S3F1 - 대시보드 고도화

```json
{
  "task_id": "S3F1",
  "task_name": "대시보드 고도화",
  "stage": "S3",
  "area": "F",
  "execution_type": "AI-Only",
  "task_instruction": {
    "목표": "사용자 대시보드 기능 고도화",
    "기능": [
      "AI 사용량 차트",
      "크레딧 잔액 표시",
      "최근 활동 목록",
      "빠른 실행 메뉴"
    ],
    "파일_생성": [
      "S3_개발-2차/Frontend/pages/dashboard/",
      "Production/Frontend/pages/dashboard/"
    ]
  },
  "task_agent": "frontend-developer",
  "verification_agent": "code-reviewer"
}
```

### S3BA1 - AI 서비스 API

```json
{
  "task_id": "S3BA1",
  "task_name": "AI 서비스 API",
  "stage": "S3",
  "area": "BA",
  "execution_type": "AI-Only",
  "task_instruction": {
    "목표": "AI 서비스 호출 및 관리 API 구현",
    "엔드포인트": [
      "POST /api/ai/chat - AI 대화",
      "POST /api/ai/summarize - 요약",
      "GET /api/ai/usage - 사용량 조회"
    ],
    "의존성": ["S3BI1 (OpenAI 연동 모듈)"]
  },
  "task_agent": "backend-developer",
  "verification_agent": "code-reviewer"
}
```

### S3BI1 - OpenAI 연동 모듈 (Human-AI)

```json
{
  "task_id": "S3BI1",
  "task_name": "OpenAI 연동 모듈",
  "stage": "S3",
  "area": "BI",
  "execution_type": "Human-AI",
  "task_instruction": {
    "AI_작업": "OpenAI API 연동 코드 및 가이드 작성",
    "PO_작업": "OpenAI API 키 발급 및 환경변수 설정"
  },
  "task_agent": "backend-developer",
  "verification_agent": "code-reviewer",
  "po_action_required": {
    "필요": true,
    "내용": "OpenAI API 키 발급 + Vercel 환경변수 설정"
  }
}
```

---

## 4. PO 필수 작업 가이드

### 4.1 OpenAI API 설정 (S3BI1)

```
1. https://platform.openai.com 접속
2. API Keys → Create new secret key
3. API Key 복사 (한 번만 표시됨!)
4. Vercel Dashboard → Settings → Environment Variables
   - OPENAI_API_KEY = [복사한 키]
5. 사용량 제한 설정 (Cost Limit)
```

### 4.2 SQL 실행 (S3D1)

```
1. Supabase Dashboard → SQL Editor
2. S3D1 SQL 파일 내용 복사 & 붙여넣기
3. Run 버튼 클릭
4. 성공 메시지 확인
5. AI에게 "실행 완료" 알림
```

---

## 5. Stage Gate 완료 기준

### PO 테스트 체크리스트

- [ ] S3F1: 대시보드 차트/데이터 표시 확인
- [ ] S3F2: 알림 센터 동작 확인
- [ ] S3F3: AI 서비스 UI 동작 확인
- [ ] S3BA1: AI API 호출 테스트
- [ ] S3BA2: 크레딧 차감 테스트
- [ ] S3D1: DB 테이블 최적화 확인

### 다음 Stage 진행 조건

```
S3 Stage 완료 → S4 Stage 시작 가능

조건:
1. 모든 S3 Task 완료 및 검증 통과
2. Stage Gate PO 승인
3. AI 서비스 실제 동작 확인
4. OpenAI API 키 설정 완료
```

---

## 6. 주의사항

```
⚠️ AI API 키 보안 철저히 관리!
⚠️ API Rate Limiting 필수 구현!
⚠️ 크레딧 차감 로직 정확성 검증!
⚠️ 비용 폭주 방지 장치 확인!
```

---

## 버전 이력

| 버전 | 날짜 | 내용 |
|------|------|------|
| 1.0 | - | 기본 템플릿 |
| 2.0 | 2025-12-17 | S2 경험 기반 역설계 종합 템플릿 |
