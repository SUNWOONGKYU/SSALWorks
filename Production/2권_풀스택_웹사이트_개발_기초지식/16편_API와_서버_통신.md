# 16편 | API와 서버 통신

---

15편에서 데이터베이스 실무를 다뤘으니, 이제는 프론트엔드와 백엔드가 서로 대화하는 방법을 살펴보겠습니다. 여러분이 인스타그램에서 '좋아요'를 누를 때, 카카오톡에서 메시지를 보낼 때, 이 모든 것이 **API를 통한 서버 통신** 덕분에 가능한 일이라고 생각하면 됩니다. 사실 우리가 매일 사용하는 모든 앱과 웹사이트가 이런 방식으로 작동하고 있습니다. API가 무엇인지, HTTP 통신이 어떻게 작동하는지, 그리고 JavaScript로 API를 호출하는 기본 방법까지 차근차근 알아보겠습니다.

## 1. API란 무엇인가

### 1-1 API의 기본 개념

**API**를 생각해보면 서로 다른 소프트웨어가 소통할 수 있게 해주는 **마법의 번역기** 같은 존재라고 생각하면 됩니다. Application Programming Interface의 약자인데, 이름은 복잡하지만 개념은 간단합니다. 마치 식당에서 메뉴판과 주문 시스템이 있는 것처럼, API는 "어떤 데이터를 어떻게 요청하고 받을 수 있는지" 정해놓은 **핵심적인 규칙**입니다.

예를 들어 날씨 앱을 생각해보면 실제로 그 작은 앱이 직접 날씨를 예측하지는 않습니다. 대신 기상청의 날씨 API에 "서울의 오늘 날씨"라고 요청을 보내면, API가 **"맑음, 25도"** 라고 친절하게 답변해주는 것입니다. 앱은 이 답변을 받아서 사용자에게 예쁘게 꾸며서 보여주는 **통역사 역할**을 하는 것입니다. 매우 효과적인 분업 시스템입니다!

사실 우리가 매일 사용하는 웹사이트와 앱들은 **수많은 API들의 협연 무대**라고 생각하면 됩니다. 인스타그램에서 사진을 업로드할 때, 유튜브에서 동영상을 시청할 때, 네이버 지도에서 길을 찾을 때 - 이 모든 순간에 보이지 않는 곳에서 API들이 바쁘게 일하고 있습니다. 게다가 각각의 버튼 클릭, 스크롤, 검색이 모두 API 호출로 이루어진다는 점이 정말 흥미로운 사실입니다.

### 1-2 API의 종류

웹 개발에서 주로 사용하는 API는 다음과 같습니다:

**REST API**: 웹 API계의 **만능 선수**라고 생각하면 됩니다. HTTP 프로토콜을 사용해서 데이터를 주고받는 방식인데, 직관적이고 사용하기 쉬워서 대부분의 웹 서비스에서 채택하고 있습니다. 처음 배우기에도 가장 적합한 방식입니다.

**GraphQL**: 페이스북(메타)에서 개발한 **맞춤형 주문 시스템**이라고 생각하면 됩니다. 필요한 데이터만 정확히 요청할 수 있어서, 모바일 앱처럼 "데이터 한 방울이 아까운" 환경에서 매우 효과적입니다.

**WebSocket**: **실시간 핫라인**이라고 보면 됩니다. 채팅, 게임, 라이브 스트리밍처럼 "지금 당장" 소통해야 하는 상황에서 사용하는 양방향 통신 방식입니다.

## 2. HTTP 통신의 이해

### 2-1 HTTP 프로토콜

**HTTP**를 생각해보면 웹에서 데이터를 주고받는 **핵심적인 규칙**입니다. HyperText Transfer Protocol의 약자인데, 클라이언트가 서버에게 요청을 보내면 서버가 응답을 돌려주는 **매우 체계적인 방식**으로 작동합니다.

이 과정은 우편 시스템과 매우 비슷합니다. 편지(요청)에 정확한 주소(URL)를 적어서 보내면, 받는 사람(서버)이 답장(응답)을 성실하게 보내주는 것입니다. 다만 인터넷에서는 이 모든 과정이 **몇 초 안에** 일어난다는 점이 특별합니다.

### 2-2 HTTP 메서드

HTTP는 요청의 목적에 따라 다른 메서드를 사용합니다:

**GET**: **"보여줘!"** 라고 말할 때 사용하는 메서드입니다. "상품 목록을 보여줘", "내 프로필 정보를 알려줘" 같은 조회 요청입니다. 가장 기본적이면서 자주 사용되는 방식입니다.

**POST**: **"새로 만들어줘!"** 할 때 사용하는 메서드입니다. "새 글을 작성해줘", "회원가입을 처리해줘" 같은 생성 요청입니다. 또한 민감한 정보도 안전하게 전송할 수 있습니다.

**PUT/PATCH**: **"수정해줘!"** 라고 요청할 때 사용합니다. PUT은 "통째로 바꿔줘", PATCH는 "이 부분만 살짝 고쳐줘"라고 생각하면 됩니다. 섬세한 차이가 있습니다.

**DELETE**: **"지워줘!"** 할 때의 메서드입니다. "이 글을 삭제해줘", "내 계정을 없애줘" 같은 삭제 요청입니다. 주의해야 할 점은 한번 지우면 되돌리기 어렵다는 것입니다.

### 2-3 HTTP 상태 코드

서버는 요청을 처리한 후 결과를 상태 코드로 알려줍니다:

```
[API 통신 플로우]

┌─────────────┐                    ┌─────────────┐
│  클라이언트  │                    │    서버     │
│ (브라우저)   │                    │   (API)     │
└──────┬──────┘                    └──────┬──────┘
       │                                   │
       │  1. HTTP Request (GET /users)    │
       ├──────────────────────────────────>│
       │                                   │
       │                                   │ 2. 데이터베이스 조회
       │                                   │
       │  3. HTTP Response (200 OK)       │
       │<──────────────────────────────────┤
       │     {                             │
       │       "users": [                  │
       │         {"id": 1, "name": "김"},  │
       │         {"id": 2, "name": "이"}   │
       │       ]                           │
       │     }                             │
       │                                   │
       ▼                                   ▼
```

**2xx (성공)**
- 200: 성공 - 요청이 정상적으로 처리됨
- 201: 생성됨 - 새로운 리소스가 성공적으로 생성됨

**4xx (클라이언트 오류)**
- 400: 잘못된 요청
- 401: 인증 필요 (로그인 필요)
- 404: 찾을 수 없음 (페이지가 없음)

**5xx (서버 오류)**
- 500: 내부 서버 오류
- 503: 서비스 이용 불가

### 2-4 JSON 데이터 형식

API 통신에서는 주로 JSON 형식으로 데이터를 주고받습니다. JavaScript Object Notation의 약자로, 사람이 읽기 쉽고 프로그램이 처리하기도 쉬운 텍스트 기반 데이터 형식입니다.

```json
{
  "name": "김개발",
  "age": 25,
  "email": "kim@example.com",
  "skills": ["HTML", "CSS", "JavaScript"]
}
```

## 3. JavaScript로 API 사용하기

### 3-1 fetch 함수 기초

JavaScript에서는 `fetch` 함수를 사용해서 API에 요청을 보냅니다. API 호출은 시간이 걸리는 작업이므로 비동기로 처리합니다.

```javascript
// 기본적인 GET 요청
fetch('https://api.example.com/data')
    .then(response => response.json())
    .then(data => console.log(data))
    .catch(error => console.error('에러:', error));
```

### 3-2 async/await 사용하기

async/await를 사용하면 비동기 코드를 더 읽기 쉽게 작성할 수 있습니다:

```javascript
async function getData() {
    try {
        const response = await fetch('https://api.example.com/data');
        const data = await response.json();
        console.log(data);
    } catch (error) {
        console.error('에러 발생:', error);
    }
}
```

### 3-3 다양한 HTTP 메서드 사용

POST, PUT, DELETE 등 다른 메서드를 사용할 때는 옵션을 추가합니다:

```javascript
// POST 요청 예시
fetch('https://api.example.com/users', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({ name: '홍길동', age: 30 })
});
```

## 4. 실제 API 활용

### 4-1 공개 API 활용하기

많은 서비스들이 무료로 사용할 수 있는 공개 API를 제공합니다:

**날씨 API**: OpenWeatherMap, 기상청 API
**뉴스 API**: NewsAPI, 네이버 뉴스 API
**지도 API**: 카카오맵, 네이버 지도, Google Maps
**번역 API**: Google Translate, 파파고
**소셜 미디어**: Twitter, Instagram, YouTube

각 API마다 사용 방법과 제한이 있으니 공식 문서를 참고해야 합니다.

### 4-2 API 키 관리

대부분의 공개 API는 API 키가 필요합니다. API 키는 비밀번호와 같아서 안전하게 관리해야 합니다:

- GitHub에 올리지 않기 (.gitignore 활용)
- 환경 변수로 관리하기
- 프론트엔드에서는 proxy 서버 활용
- 사용량 제한 설정하기

### 4-3 CORS 이해하기

CORS(Cross-Origin Resource Sharing)는 브라우저가 다른 도메인의 API를 안전하게 호출할 수 있도록 하는 보안 메커니즘입니다.

예를 들어 localhost:3000에서 실행 중인 웹사이트가 api.example.com의 데이터를 요청할 때 CORS 설정이 필요합니다.

**CORS 오류 해결 방법:**
- 서버에서 CORS 헤더 설정
- 프록시 서버 사용
- 개발 중에는 브라우저 확장 프로그램 활용

## 5. API 설계 원칙 (RESTful API)

### 5-1 RESTful 설계

REST는 API를 설계하는 원칙입니다. RESTful API는 다음 규칙을 따릅니다:

**명사를 사용한 리소스 표현**
- 좋음: /users, /posts, /products
- 나쁨: /getUsers, /createPost

**HTTP 메서드로 동작 표현**
- GET /users (사용자 목록 조회)
- POST /users (새 사용자 생성)
- PUT /users/1 (사용자 1번 수정)
- DELETE /users/1 (사용자 1번 삭제)

### 5-2 API 문서화

API를 만들 때는 문서화가 중요합니다. 다른 개발자(미래의 나 포함)가 API를 쉽게 사용할 수 있도록:

- 각 엔드포인트의 용도 설명
- 요청/응답 예시 제공
- 에러 코드와 해결 방법
- 사용 제한과 인증 방법

## 6. 에러 처리와 디버깅

### 6-1 일반적인 에러들

API 사용 시 자주 만나는 에러들:

**네트워크 에러**: 인터넷 연결 문제
**404 Not Found**: 잘못된 URL
**401 Unauthorized**: 인증 토큰 문제
**429 Too Many Requests**: API 호출 횟수 초과
**500 Server Error**: 서버 측 문제

### 6-2 디버깅 팁

**브라우저 개발자 도구 활용**
- Network 탭에서 API 호출 확인
- Console에서 에러 메시지 확인
- Response 탭에서 응답 데이터 확인

**단계별 확인**
1. URL이 정확한지 확인
2. HTTP 메서드가 맞는지 확인
3. 헤더 설정이 올바른지 확인
4. 요청 데이터 형식이 맞는지 확인
5. 인증 토큰이 유효한지 확인

## 7. 보안 고려사항

### 7-1 API 보안 기초

API를 안전하게 사용하기 위한 기본 원칙:

- HTTPS 사용 (HTTP는 데이터가 노출됨)
- 민감한 정보는 헤더나 바디에 포함
- API 키는 절대 클라이언트 코드에 노출하지 않음
- 입력값 검증과 이스케이프 처리
- Rate Limiting으로 과도한 호출 방지

### 7-2 인증과 권한

**인증(Authentication)**: **"당신이 누구인지"**를 확인하는 과정
- API 키 - 가장 간단한 방법
- OAuth 2.0 - 구글, 페이스북 로그인 등에서 사용
- JWT (JSON Web Token) - 현대적이고 안전한 방식

**권한(Authorization)**: **"당신이 무엇을 할 수 있는지"**를 확인하는 과정
- 역할 기반 접근 제어 - 관리자, 사용자, 게스트 등 역할별 권한
- 리소스별 권한 설정 - 특정 데이터에 대한 개별 권한

---

**작성일: 2025-09-23 / 수정일: 2025-12-20 / 글자수: 약 5,100자 / 작성자: Claude / 프롬프터: 써니**
