# 인증 코드는 숫자 6자리로

## 핵심 요약

이메일 인증, 비밀번호 재설정 등의 인증 코드는 숫자 6자리로 설정하세요. 사용자가 입력하기 쉽고 보안도 충분합니다.

## 왜 숫자 6자리인가?

### 다른 형식과 비교

| 형식 | 예시 | 입력 편의성 | 보안 |
|------|------|-------------|------|
| 숫자 4자리 | 1234 | ✅ 매우 쉬움 | ❌ 약함 (10,000개) |
| **숫자 6자리** | 123456 | **✅ 쉬움** | **✅ 충분 (1,000,000개)** |
| 숫자 8자리 | 12345678 | ⚠️ 보통 | ✅ 강함 |
| 영문+숫자 | A3B2C1 | ❌ 어려움 | ✅ 강함 |
| UUID | 550e8400-e29b... | ❌ 매우 어려움 | ✅ 매우 강함 |

### 숫자 6자리의 장점

```
✅ 사용자 편의성
- 모바일에서 숫자 키패드로 빠르게 입력
- 대소문자 구분 없음
- 오타 가능성 낮음
- 기억하기 쉬움

✅ 보안성
- 1,000,000개의 조합 (10^6)
- 짧은 유효시간(5-10분)과 결합하면 충분한 보안
- 시도 횟수 제한(3-5회)으로 무차별 대입 방지
```

## Claude Code에게 지시하기

### 이메일 인증 코드 구현

```
"이메일 인증 코드 기능 만들어줘.
- 코드: 숫자 6자리
- 유효시간: 5분
- 시도 횟수: 3회 제한"
```

### 비밀번호 재설정 코드

```
"비밀번호 재설정용 인증 코드 구현해줘.
- 숫자 6자리 코드 생성
- 10분 후 만료
- 이메일로 발송"
```

### 휴대폰 본인 인증

```
"SMS 인증 코드 기능 만들어줘.
- 6자리 숫자 코드
- 3분 유효
- 재발송은 1분 후 가능"
```

## 구현 예시

### 코드 생성 (JavaScript)

```javascript
// 숫자 6자리 인증 코드 생성
function generateVerificationCode() {
  return Math.floor(100000 + Math.random() * 900000).toString();
}

// 예: "382947"
```

### 코드 생성 (Python)

```python
import random

def generate_verification_code():
    return str(random.randint(100000, 999999))

# 예: "593812"
```

### 데이터베이스 저장

```sql
CREATE TABLE verification_codes (
  id SERIAL PRIMARY KEY,
  user_email VARCHAR(255) NOT NULL,
  code CHAR(6) NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP NOT NULL,
  attempts INT DEFAULT 0,
  is_used BOOLEAN DEFAULT FALSE
);
```

## 보안 강화 방법

### 1. 유효시간 설정

```
권장 유효시간:
- 이메일 인증: 5~10분
- SMS 인증: 3~5분
- 비밀번호 재설정: 15~30분
```

### 2. 시도 횟수 제한

```
권장:
- 최대 시도 횟수: 3~5회
- 초과 시: 새 코드 재발급 필요
- 연속 실패 시: 일정 시간 잠금
```

### 3. 재발송 제한

```
권장:
- 재발송 쿨다운: 60초~120초
- 일일 최대 발송 횟수: 5~10회
- 과다 요청 시: 계정 일시 잠금
```

## 사용자 경험 개선

### 입력 UI 설계

```
"인증 코드 입력 UI 만들어줘:
- 6개의 개별 입력칸
- 자동 포커스 이동
- 숫자만 입력 가능
- 붙여넣기 지원"
```

### 예시 화면

```
인증 코드를 입력하세요

[ 3 ] [ 8 ] [ 2 ] [ 9 ] [ 4 ] [ 7 ]

남은 시간: 4:23

[재발송] [확인]
```

## 인증 흐름 전체

```
1. 사용자 인증 요청 (이메일/전화번호 입력)
     ↓
2. 서버에서 6자리 코드 생성
     ↓
3. 코드 + 유효시간 DB 저장
     ↓
4. 이메일/SMS로 코드 발송
     ↓
5. 사용자 코드 입력
     ↓
6. 서버에서 검증
   - 코드 일치 여부
   - 유효시간 경과 여부
   - 시도 횟수 초과 여부
     ↓
7. 성공 → 다음 단계 진행
   실패 → 오류 메시지 표시
```

## 자주 하는 실수

| 실수 | 문제점 | 해결 |
|------|--------|------|
| 유효시간 없음 | 코드 재사용 가능 | 5~10분 유효시간 설정 |
| 시도 제한 없음 | 무차별 대입 공격 | 3~5회 제한 |
| 영문 포함 | 입력 불편 | 숫자만 사용 |
| 4자리 코드 | 보안 취약 | 6자리 사용 |
| 코드 노출 | URL/로그에 노출 | 암호화/해싱 |

## 주의사항

- 코드는 서버 측에서만 생성 (클라이언트 생성 금지)
- 로그에 인증 코드 기록 금지
- HTTPS로만 코드 전송
- 사용된 코드는 즉시 무효화
- 이메일/SMS 발송 실패 처리 필수
- 테스트 환경에서는 콘솔 출력으로 코드 확인 가능하게 설정

