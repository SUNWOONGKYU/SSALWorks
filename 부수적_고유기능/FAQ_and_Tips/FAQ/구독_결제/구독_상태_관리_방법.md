# 구독 상태 관리 방법

## 질문
구독 상태(활성, 일시정지, 해지)는 어떻게 관리하나요?

## 답변

### 구독 상태 종류

| 상태 | 설명 |
|------|------|
| `active` | 정상 구독 중 |
| `paused` | 일시정지 |
| `cancelled` | 해지됨 |
| `expired` | 만료됨 |

### 데이터베이스 컬럼

**users 테이블의 구독 관련 컬럼**
```sql
subscription_status VARCHAR(20) DEFAULT 'none'  -- 구독 상태
subscription_plan VARCHAR(20)                     -- 구독 플랜 (basic, pro, enterprise)
subscription_start_date TIMESTAMP                 -- 구독 시작일
subscription_end_date TIMESTAMP                   -- 구독 종료 예정일
```

**확장 컬럼 (선택사항)**
```sql
subscription_paused_at TIMESTAMP      -- 일시정지 시작일
subscription_pause_end_date TIMESTAMP -- 일시정지 만료일
subscription_cancelled_at TIMESTAMP   -- 해지일
```

### 구독 상태 변경 로직

**일시정지**
```javascript
await supabase
    .from('users')
    .update({
        subscription_status: 'paused',
        subscription_paused_at: new Date().toISOString()
    })
    .eq('id', userId);
```

**해지**
```javascript
await supabase
    .from('users')
    .update({
        subscription_status: 'cancelled',
        subscription_cancelled_at: new Date().toISOString()
    })
    .eq('id', userId);
```

### 관련 파일
- `P3_프로토타입_제작/Database/23_add_subscription_columns.sql`
